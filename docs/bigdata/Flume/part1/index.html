<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Flume | 知识库</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials">
    <meta name="description" content="">
    <meta property="og:url" content="/bigdata/Flume/part1.html">
    <meta property="og:site_name" content="知识库">
    <meta property="og:title" content="Flume">
    <meta property="og:description" content="Flume 概述 Flume，是一个日志采集系统，Cloudera 提供，是高可用的、高可靠的、分布式的，海量日志采集、聚合、传输的系统。Flume 流式架构，灵活简单。 Flume 可以从多个渠道获取内容，写入到多种渠道。 Flume 基础架构 Agent 一个 JVM 进程，主要由 Source、Channel、Sink 组成。它会将数据以事件的方式从源">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="知识库">
    <meta property="article:author" content="causes">
    <meta property="article:tag" content="flume">
    <meta name="theme-color" content="#46bd87">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    
    <link rel="preload" href="/assets/css/0.styles.272a7e09.css" as="style"><link rel="preload" href="/assets/js/app.00946664.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Layout.d74da02a.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.70129eef.js" as="script"><link rel="preload" href="/assets/js/page-Flume.578f4bbc.js" as="script"><link rel="prefetch" href="/assets/js/54.7c746378.js"><link rel="prefetch" href="/assets/js/55.adda53bb.js"><link rel="prefetch" href="/assets/js/56.0f8d034a.js"><link rel="prefetch" href="/assets/js/57.830d518c.js"><link rel="prefetch" href="/assets/js/58.fcb3cf84.js"><link rel="prefetch" href="/assets/js/59.2826e1cb.js"><link rel="prefetch" href="/assets/js/layout-Blog.65a26112.js"><link rel="prefetch" href="/assets/js/layout-Layout.ae1bffbb.js"><link rel="prefetch" href="/assets/js/layout-NotFound.afd3c492.js"><link rel="prefetch" href="/assets/js/layout-Slide.5d36817b.js"><link rel="prefetch" href="/assets/js/page--6ce8a11a.1f6d1c8c.js"><link rel="prefetch" href="/assets/js/page-Concurrent-01-基础.40d9681c.js"><link rel="prefetch" href="/assets/js/page-Docker-01-基础.83220b10.js"><link rel="prefetch" href="/assets/js/page-Docker-02-进阶.52df0704.js"><link rel="prefetch" href="/assets/js/page-Flink-01-基础.068f6e0e.js"><link rel="prefetch" href="/assets/js/page-Flink-02-进阶.a6789756.js"><link rel="prefetch" href="/assets/js/page-Flink-03-机制.c3604e6d.js"><link rel="prefetch" href="/assets/js/page-Git-01-常用指令.93e85005.js"><link rel="prefetch" href="/assets/js/page-HBase-01-起步.7316acb2.js"><link rel="prefetch" href="/assets/js/page-HBase-02-进阶.11b27c25.js"><link rel="prefetch" href="/assets/js/page-Hadoop-01-起步.f49b25f0.js"><link rel="prefetch" href="/assets/js/page-Hadoop-02-HDFS.c28c360c.js"><link rel="prefetch" href="/assets/js/page-Hadoop-03-MapReduce.01e7c831.js"><link rel="prefetch" href="/assets/js/page-Hadoop-04-Yarn.ffaa99bb.js"><link rel="prefetch" href="/assets/js/page-Hive-01-起步.c51a8ed6.js"><link rel="prefetch" href="/assets/js/page-Hive-02-DDL.62ca23de.js"><link rel="prefetch" href="/assets/js/page-Hive-03-DML.d3eb8c90.js"><link rel="prefetch" href="/assets/js/page-Hive-04-DQL.c2e0815a.js"><link rel="prefetch" href="/assets/js/page-Hive-05-函数.585851e7.js"><link rel="prefetch" href="/assets/js/page-JVM-01-概述.ebc66336.js"><link rel="prefetch" href="/assets/js/page-JVM-02-类加载子系统.4442a927.js"><link rel="prefetch" href="/assets/js/page-JVM-03-运行时数据区.947c0cac.js"><link rel="prefetch" href="/assets/js/page-Kafka-01-起步.246fa824.js"><link rel="prefetch" href="/assets/js/page-Kafka-02-架构和API.95741e08.js"><link rel="prefetch" href="/assets/js/page-Kafka-03-组件对接.adf6b6fb.js"><link rel="prefetch" href="/assets/js/page-Kubernetes-01-环境搭建.ee022329.js"><link rel="prefetch" href="/assets/js/page-Kubernetes-02-操作.0263d70c.js"><link rel="prefetch" href="/assets/js/page-Linux-01-基础篇.7a082019.js"><link rel="prefetch" href="/assets/js/page-Linux-02-实际操作篇.a1a0de05.js"><link rel="prefetch" href="/assets/js/page-Linux-03-安装配置.4afb662a.js"><link rel="prefetch" href="/assets/js/page-Linux-04-Shell.4bea5dda.js"><link rel="prefetch" href="/assets/js/page-Proxy.4595451b.js"><link rel="prefetch" href="/assets/js/page-Spark-01-SparkCore.e1b13d59.js"><link rel="prefetch" href="/assets/js/page-Spark-02-SparkSQL.0e447d14.js"><link rel="prefetch" href="/assets/js/page-Zookeeper.d3a8c3a8.js"><link rel="prefetch" href="/assets/js/page-数据结构与算法-01-概述.da9332d8.js"><link rel="prefetch" href="/assets/js/page-注意事项.97c989bf.js"><link rel="prefetch" href="/assets/js/page-设计模式-01-介绍.2a0d66a1.js"><link rel="prefetch" href="/assets/js/page-设计模式-02-创建者模式.4c12c25f.js"><link rel="prefetch" href="/assets/js/page-设计模式-03-结构型模式.af84c495.js"><link rel="prefetch" href="/assets/js/page-设计模式-04-行为型模式.2a0f6172.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.f091f770.js"><link rel="prefetch" href="/assets/js/vendors~mermaid.9c96c271.js"><link rel="prefetch" href="/assets/js/vendors~photo-swipe.e4b622ba.js"><link rel="prefetch" href="/assets/js/vendors~reveal.80ac799a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.272a7e09.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container has-navbar has-anchor"><header class="navbar"><!----> <div class="content__navbar-start"></div> <button title="Sidebar Button" class="sidebar-button"><span class="icon"></span></button> <a href="/" class="home-link router-link-active"><!----> <!----> <span class="site-name can-hide">知识库</span></a> <!----> <div class="content__navbar-center"></div> <div class="links"><button tabindex="-1" aria-hidden="true" class="color-button"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="skin-icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4
        38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32
        51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0
        102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2
        6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4
        0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2
        9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224
        419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4
        470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0
        22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6
        12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128
        505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2
        16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8
        86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4
        80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6
        6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><ul class="themecolor-select"><label for="themecolor-select">Theme Color:</label> <li><span class="default-theme"></span></li> </ul> <div class="darkmode-toggle"><label for="darkmode-toggle" class="desc">Theme Mode:</label> <div class="darkmode-switch"><div class="item day"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon light-icon"><path d="M512 256a42.667 42.667 0 0 0 42.667-42.667V128a42.667 42.667 0 0 0-85.334 0v85.333A42.667 42.667 0 0 0 512 256zm384 213.333h-85.333a42.667 42.667 0 0 0 0 85.334H896a42.667 42.667 0 0 0 0-85.334zM256 512a42.667 42.667 0 0 0-42.667-42.667H128a42.667 42.667 0 0 0 0 85.334h85.333A42.667 42.667 0 0 0 256 512zm9.387-298.667a42.667 42.667 0 0 0-59.307 62.72l61.44 59.307a42.667 42.667 0 0 0 31.147 11.947 42.667 42.667 0 0 0 30.72-13.227 42.667 42.667 0 0 0 0-60.16zm459.946 133.974a42.667 42.667 0 0 0 29.44-11.947l61.44-59.307a42.667 42.667 0 0 0-57.6-62.72l-61.44 60.587a42.667 42.667 0 0 0 0 60.16 42.667 42.667 0 0 0 28.16 13.227zM512 768a42.667 42.667 0 0 0-42.667 42.667V896a42.667 42.667 0 0 0 85.334 0v-85.333A42.667 42.667 0 0 0 512 768zm244.48-79.36a42.667 42.667 0 0 0-59.307 61.44l61.44 60.587a42.667 42.667 0 0 0 29.44 11.946 42.667 42.667 0 0 0 30.72-12.8 42.667 42.667 0 0 0 0-60.586zm-488.96 0-61.44 59.307a42.667 42.667 0 0 0 0 60.586 42.667 42.667 0 0 0 30.72 12.8 42.667 42.667 0 0 0 28.587-10.666l61.44-59.307a42.667 42.667 0 0 0-59.307-61.44zM512 341.333A170.667 170.667 0 1 0 682.667 512 170.667 170.667 0 0 0 512 341.333z" fill="currentColor"></path></svg></div> <div class="item auto active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon auto-icon"><path d="M460.864 539.072H564.8L510.592 376l-49.728 163.072zM872 362.368V149.504H659.648L510.528 0l-149.12 149.504H149.12v212.928L0 511.872l149.12 149.504v212.928h212.352l149.12 149.504 149.12-149.504h212.352V661.376l149.12-149.504L872 362.368zM614.464 693.12l-31.616-90.624H438.272l-31.616 90.624h-85.888l144.576-407.68h90.368l144.576 407.68h-85.824zm0 0" fill="currentColor"></path></svg></div> <div class="item night"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon dark-icon"><path d="M935.539 630.402c-11.43-11.432-28.674-14.739-43.531-8.354-46.734 20.103-96.363 30.297-147.508 30.297-99.59 0-193.221-38.784-263.64-109.203-108.637-108.637-139.61-270.022-78.908-411.148a39.497 39.497 0 0 0-51.886-51.887c-52.637 22.64-100.017 54.81-140.826 95.616-85.346 85.346-132.346 198.821-132.346 319.52 0 120.7 47.001 234.172 132.347 319.519S408.063 947.11 528.76 947.11c120.7 0 234.172-47.003 319.52-132.351 40.809-40.81 72.978-88.19 95.616-140.826a39.497 39.497 0 0 0-8.356-43.532z" fill="currentColor"></path></svg></div></div> <!----></div></div></div></button> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link router-link-active"><i class="iconfont icon-reco-home"></i>
  首页
</a></div><div class="nav-item"><a href="/about.html" class="nav-link"><i class="iconfont icon-reco-faq"></i>
  关于
</a></div></nav> <!----> <a rel="noopener noreferrer" href="https://gitlab.com/team401/knowledge" target="_blank" class="repo-link can-hide">
  GitLab
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <!----> <div class="content__navbar-end"></div></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><div vocab="https://schema.org/" typeof="Person" class="blogger-info"><div data-balloon-pos="" role="navigation" class="blogger"><!----> <div property="name" class="name">知识库</div> <!----></div> <div class="num-wrapper"><div><div class="num">41</div> <div>Articles</div></div> <div><div class="num">3</div> <div>Category</div></div> <div><div class="num">17</div> <div>Tags</div></div> <div><div class="num">41</div> <div>Timeline</div></div></div> <!----></div> <hr> <!----> <div class="content__sidebar-top"></div> <nav class="sidebar-nav-links"><div class="nav-item"><a href="/" class="nav-link router-link-active"><i class="iconfont icon-reco-home"></i>
  首页
</a></div><div class="nav-item"><a href="/about.html" class="nav-link"><i class="iconfont icon-reco-faq"></i>
  关于
</a></div> <a rel="noopener noreferrer" href="https://gitlab.com/team401/knowledge" target="_blank" class="repo-link">
  GitLab
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav> <!----> <div class="content__sidebar-center"></div> <!----> <!----> <div class="content__sidebar-bottom"></div> <!----></aside> <main class="page"><nav class="breadcrumb disable"><!----></nav> <!----> <div class="content__page-top"></div> <div vocab="https://schema.org/" typeof="Article" class="page-title"><h1><!----> <span property="headline">Flume</span></h1> <div class="page-info"><!----> <span aria-label="Author🖊" data-balloon-pos="down"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon author-icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z" fill="currentColor"></path></svg> <span property="author">causes</span></span><!----><span aria-label="Writing Date📅" data-balloon-pos="down" class="time-info"><svg viewBox="0 0 1030 1024" xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H180.6A134.314 134.314 0 0 0 46.66 277.595v535.756A134.314 134.314 0 0 0 180.6 947.289h669.74a134.36 134.36 0 0 0 133.94-133.938V277.595a134.314 134.314 0 0 0-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 0 1-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 0 1-33.472 33.473z" fill="currentColor"></path></svg> <span property="datePublished">2022-3-16</span></span><!----><span aria-label="Tags🏷" data-balloon-pos="down"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon tag-icon"><path d="M939.902 458.563 910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 0 0 0 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z" fill="currentColor"></path></svg> <ul class="tags-wrapper"><li class="tag clickable tag0"><span role="navigation">Flume</span></li></ul> <meta property="keywords" content="Flume"></span><span aria-label="Reading Time⌛" data-balloon-pos="down" class="reading-time-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon timer-icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z" fill="currentColor"></path></svg> <span>About 13 min</span> <meta property="timeRequired" content="PT13M"></span></div> <!----> <hr></div> <div class="anchor-place-holder"><aside id="anchor"><div class="anchor-wrapper"><ul class="anchor-list"><li class="anchor"><a href="/bigdata/Flume/part1/#flume-概述" class="anchor-link heading2"><div>Flume 概述</div></a></li><li class="anchor"><a href="/bigdata/Flume/part1/#flume-基础架构" class="anchor-link heading2"><div>Flume 基础架构</div></a></li><li class="anchor"><a href="/bigdata/Flume/part1/#flume-开始" class="anchor-link heading2"><div>Flume 开始</div></a></li><li class="anchor"><a href="/bigdata/Flume/part1/#安装部署" class="anchor-link heading3"><div>安装部署</div></a></li><li class="anchor"><a href="/bigdata/Flume/part1/#入门案例" class="anchor-link heading3"><div>入门案例</div></a></li><li class="anchor"><a href="/bigdata/Flume/part1/#事务" class="anchor-link heading2"><div>事务</div></a></li><li class="anchor"><a href="/bigdata/Flume/part1/#agent-内部原理" class="anchor-link heading2"><div>Agent 内部原理</div></a></li><li class="anchor"><a href="/bigdata/Flume/part1/#拓扑结构" class="anchor-link heading2"><div>拓扑结构</div></a></li><li class="anchor"><a href="/bigdata/Flume/part1/#自定义组件" class="anchor-link heading2"><div>自定义组件</div></a></li></ul></div></aside></div> <!----> <div class="content__content-top"></div> <div class="theme-default-content content__default"><h2 id="flume-概述"><a href="#flume-概述" class="header-anchor">#</a> Flume 概述</h2> <p>Flume，是一个日志采集系统，Cloudera 提供，是高可用的、高可靠的、分布式的，海量日志采集、聚合、传输的系统。Flume 流式架构，灵活简单。</p> <p>Flume 可以从多个渠道获取内容，写入到多种渠道。</p> <p><img src="/assets/img/2022-03-16-15-04-08.bde95ece.png" alt=""></p> <h2 id="flume-基础架构"><a href="#flume-基础架构" class="header-anchor">#</a> Flume 基础架构</h2> <p><img src="/assets/img/2022-03-16-15-04-28.17e409ea.png" alt=""></p> <p><strong>Agent</strong></p> <p>一个 JVM 进程，主要由 Source、Channel、Sink 组成。它会将数据以事件的方式从源头送到目的地。</p> <p><strong>Source</strong></p> <p>主要负责从源头将数据接受，Source 组件可以处理多种格式的数据，比如 avro、thrift、exec、jms、spooling directory、netcat、taildir、sequence generator、http、legacy 等。</p> <p><strong>Channel</strong></p> <p>主要用于传输，将数据源中的数据传送到目的地。可以看成是一个缓冲区，因此 Channel 允许 Source 和 Sink 运送在不用的速率上。</p> <p>Channel 线程安全，可以同时处理几个 Source 的写入和几个 Sink 的读取。</p> <p><strong>Sink</strong></p> <p>Sink 位于 Agent 的消费端。它不断轮询 Channel 中的事件并且批量移除它们，并且将这些事件写入到存储中，或者发送到下一个 Flume Agent。</p> <p>Sink 的目的地有：HDFS、Logger、avro、thrift、ipc、file、HBase、solr、自定义等。</p> <p><strong>Event</strong></p> <p>Flume 中，数据传输的最小单元。包含 Header 和 Body 两部分，Header 为 kv 结构，存放一些属性。Body 存放一些数据，形式是字节数组。</p> <p><img src="/assets/img/2022-03-16-15-11-35.2787e2ff.png" alt=""></p> <h2 id="flume-开始"><a href="#flume-开始" class="header-anchor">#</a> Flume 开始</h2> <h3 id="安装部署"><a href="#安装部署" class="header-anchor">#</a> 安装部署</h3> <ol><li><a href="http://flume.apache.org/" target="_blank" rel="noopener noreferrer">官网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，下载 <code>apache-flume-1.9.0.tar-gz</code> 即可。</li> <li>上传到服务器 <code>/opt/software</code>，解压到 <code>/opt/module</code>。</li> <li>配置环境变量。</li> <li>如果安装了 Hadoop，需要删除 lib 包下的 <code>guava-11.0.2</code>，兼容 <code>Hadoop3.1.3</code>。</li></ol> <h3 id="入门案例"><a href="#入门案例" class="header-anchor">#</a> 入门案例</h3> <p><strong>监听端口</strong></p> <ol><li><p>思路：监听端口 44444，收集此端口的数据，并且打印到控制台中。</p></li> <li><p>安装 <code>netcat</code>，此工具可以用于向端口发送数据：<code>yum -y install nc</code></p></li> <li><p>判断 44444 是否被占用：<code>sudo netstat -lnp | grep 44444</code></p></li> <li><p>在 Flume Agent HOME 目录下创建 job 文件夹，并且进入。</p></li> <li><p>创建配置文件 <code>flume-netcat-logger.conf</code>，以下配置来自官方<a href="https://flume.apache.org/FlumeUserGuide.html" target="_blank" rel="noopener noreferrer">手册<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <details class="custom-block details"><summary>监控端口</summary> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token comment"># Name the components on this agent</span>
<span class="token comment"># r1：a1 的 source 名称</span>
<span class="token attr-name">a1.sources</span> <span class="token punctuation">=</span> <span class="token attr-value">r1</span>
<span class="token comment"># k1：a1 的 sink 名称</span>
<span class="token attr-name">a1.sinks</span> <span class="token punctuation">=</span> <span class="token attr-value">k1</span>
<span class="token comment"># c1：a1 的 channel 名称</span>
<span class="token attr-name">a1.channels</span> <span class="token punctuation">=</span> <span class="token attr-value">c1</span>

<span class="token comment"># Describe/configure the source</span>
<span class="token comment"># a1 的输入源为 netcat</span>
<span class="token attr-name">a1.sources.r1.type</span> <span class="token punctuation">=</span> <span class="token attr-value">netcat</span>
<span class="token comment"># a1 监听主机</span>
<span class="token attr-name">a1.sources.r1.bind</span> <span class="token punctuation">=</span> <span class="token attr-value">localhost</span>
<span class="token comment"># a1 监听端口号</span>
<span class="token attr-name">a1.sources.r1.port</span> <span class="token punctuation">=</span> <span class="token attr-value">44444</span>

<span class="token comment"># Describe the sink</span>
<span class="token comment"># a1 输出类型为控制台 logger</span>
<span class="token attr-name">a1.sinks.k1.type</span> <span class="token punctuation">=</span> <span class="token attr-value">logger</span>

<span class="token comment"># Use a channel which buffers events in memory</span>
<span class="token comment"># a1 的 channel 类型为内存</span>
<span class="token attr-name">a1.channels.c1.type</span> <span class="token punctuation">=</span> <span class="token attr-value">memory</span>
<span class="token comment"># a1 的 channel 总容量为 1000 个 event</span>
<span class="token attr-name">a1.channels.c1.capacity</span> <span class="token punctuation">=</span> <span class="token attr-value">1000</span>
<span class="token comment"># a1 的 channel 传输时收集到了 100 条 event 之后再去提交事务</span>
<span class="token attr-name">a1.channels.c1.transactionCapacity</span> <span class="token punctuation">=</span> <span class="token attr-value">100</span>

<span class="token comment"># Bind the source and sink to the channel</span>
<span class="token comment"># source r1 和 channel c1 连接</span>
<span class="token attr-name">a1.sources.r1.channels</span> <span class="token punctuation">=</span> <span class="token attr-value">c1</span>
<span class="token comment"># channel c1 和 sink k1 连接</span>
<span class="token attr-name">a1.sinks.k1.channel</span> <span class="token punctuation">=</span> <span class="token attr-value">c1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div></details></li> <li><p>开启 flume，监听端口：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 方法一：</span>
bin/flume-ng agent --conf conf/ --name a1 --conf-file job/flume-netcat-logger.conf -Dflume.root.logger<span class="token operator">=</span>INFO,console
<span class="token comment"># 方法二：</span>
bin/flume-ng agent -c conf -n a1 -f job/flume-netcat-logger.conf -Dflume.root.logger<span class="token operator">=</span>INFO,console
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>--conf/-c</code>：配置文件存储在 <code>conf/</code> 下。</li> <li><code>--name/-n</code>：给 agent 起名。</li> <li><code>--conf-file/-f</code>：本次 flume 启动时执行的读取的配置文件时使用的文件。</li> <li><code>-Dflume.root.logger=INFO,console</code>：<code>-D</code> 表示 flume 运行时动态修改 <code>flume.root.logger</code> 参数属性值，并且将级别改为 <code>INFO</code>（日志级别：<code>LOG、INFO、WARN、ERROR</code>）。</li></ul></li> <li><p>netcat 向本机 44444 发送内容：<code>nc localhost 44444</code>，之后便可以发送内容。</p></li> <li><p>结果：</p> <p><img src="data:image/png;base64,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" alt=""></p> <p><img src="data:image/png;base64,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" alt=""></p></li></ol> <p><strong>监听单个文件</strong></p> <p>监控 Hive 日志，并且上传到 HDFS 中。</p> <ol><li><p>Flume 需要 Hadoop 相关的 jar 包才可以进行此操作。检查 Hadoop 和 Java 环境变量配置。</p></li> <li><p>在 job 文件夹下创建 <code>flume-file-hdfs.conf</code> 文件</p> <p>由于 Hive 日志在 Linux 中，所以读取文件需要按照 Linux 的规则来，下方 <code>exec</code> 指的是 <code>execute</code> 执行，表示执行 Linux 命令。</p> <p>对于所有和时间相关的转义序列，Event Header 必须含有时间戳，也就是以 timestamp 的 key（除非 <code>hdfs.useLocalTimeStamp</code> 设置为 true，也就是使用本地时间）。</p> <details class="custom-block details"><summary>监控文件</summary> <div class="language- line-numbers-mode"><pre class="language-text"><code># 定义 source、sink、channel
a2.sources = r2
a2.sinks = k2
a2.channels = c2

# 定义 source 类型为执行命令，命令为 tail -F /opt/module/apache-hive-3.1.2-bin/logs/hive.log
a2.sources.r2.type = exec
a2.sources.r2.command = tail -F /opt/module/hive/logs/hive.log

a2.sinks.k2.type = hdfs
a2.sinks.k2.hdfs.path = hdfs://hadoop102:8020/flume/%Y%m%d/%H
# 上传文件的前缀
a2.sinks.k2.hdfs.filePrefix = logs-
# 是否按照时间滚动文件夹
a2.sinks.k2.hdfs.round = true
# 多少时间单位创建一个新的文件夹
a2.sinks.k2.hdfs.roundValue = 1
# 重新定义时间单位
a2.sinks.k2.hdfs.roundUnit = hour
# 是否使用本地时间戳
a2.sinks.k2.hdfs.useLocalTimeStamp = true
# 积攒多少个 Event 才 flush 到 HDFS 一次
a2.sinks.k2.hdfs.batchSize = 100
# 设置文件类型，可支持压缩
a2.sinks.k2.hdfs.fileType = DataStream
# 多久生成一个新的文件
a2.sinks.k2.hdfs.rollInterval = 60
# 设置每个文件的滚动大小
a2.sinks.k2.hdfs.rollSize = 134217700
# 文件的滚动与 Event 数量无关
a2.sinks.k2.hdfs.rollCount = 0

# 缓冲区类型、大小
a2.channels.c2.type = memory
a2.channels.c2.capacity = 1000
a2.channels.c2.transactionCapacity = 100

# 绑定 source、channel、sink
a2.sources.r2.channels = c2
a2.sinks.k2.channel = c2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div></details></li> <li><p>运行 flume：<code>bin/flume-ng agent -c conf -n a2 -f job/flume-file-hdfs.conf -Dflume.root.logger=INFO,console</code></p> <p>如果报错 <code>Exception in thread “SinkRunner-PollingRunner-DefaultSinkProcessor“ java.lang.NoSuchMethodError</code>，可以将 <code>$HADOOP_HOME/share/hadoop/common/lib</code> 下的 <code>guava-27.0-jre.jar</code> 覆盖 <code>$FLUME_HOME/lib</code> 的低版本 guava</p></li> <li><p>开启 Hadoop 和 Hive</p></li> <li><p>在 HDFS 上查看文件</p></li></ol> <p><strong>监控目录下多个文件</strong></p> <ol><li><p>创建 <code>job/flume-dir-hdfs.conf</code></p> <details class="custom-block details"><summary>监控目录下多个文件</summary> <div class="language- line-numbers-mode"><pre class="language-text"><code># 定义 source、channel、sink
a3.sources = r3
a3.sinks = k3
a3.channels = c3

# spooldir：定义 source 类型为目录，spoolDir：给定目录位置，fileSuffix：给定文件上传完成的后缀，fileHeader：是否有文件头
a3.sources.r3.type = spooldir
a3.sources.r3.spoolDir = /opt/module/apache-flume-1.9.0/upload
a3.sources.r3.fileSuffix = .COMPLETED
a3.sources.r3.fileHeader = true
#忽略所有以.tmp结尾的文件，不上传
a3.sources.r3.ignorePattern = ([^ ]*\.tmp)

# Describe the sink
a3.sinks.k3.type = hdfs
a3.sinks.k3.hdfs.path = hdfs://hadoop102:8020/flume/upload/%Y%m%d/%H
#上传文件的前缀
a3.sinks.k3.hdfs.filePrefix = upload-
#是否按照时间滚动文件夹
a3.sinks.k3.hdfs.round = true
#多少时间单位创建一个新的文件夹
a3.sinks.k3.hdfs.roundValue = 1
#重新定义时间单位
a3.sinks.k3.hdfs.roundUnit = hour
#是否使用本地时间戳
a3.sinks.k3.hdfs.useLocalTimeStamp = true
#积攒多少个Event才flush到HDFS一次
a3.sinks.k3.hdfs.batchSize = 100
#设置文件类型，可支持压缩
a3.sinks.k3.hdfs.fileType = DataStream
#多久生成一个新的文件
a3.sinks.k3.hdfs.rollInterval = 60
#设置每个文件的滚动大小大概是128M
a3.sinks.k3.hdfs.rollSize = 134217700
#文件的滚动与Event数量无关
a3.sinks.k3.hdfs.rollCount = 0

# Use a channel which buffers events in memory
a3.channels.c3.type = memory
a3.channels.c3.capacity = 1000
a3.channels.c3.transactionCapacity = 100

# banding source、channel、sink
a3.sources.r3.channels = c3
a3.sinks.k3.channel = c3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div></details> <p>使用 Spooling Directory Source 时，不要在监控目录下持续创建并修改文件。</p> <p>上传的文件会以 <code>.COMPLETED</code> 结尾，比如 <code>atguigu.log.COMPLETED</code>。</p> <p>被监控的文件夹每 500ms 扫描一次文件变动。</p></li> <li><p>在此文件夹下添加文件即可。</p></li></ol> <p><strong>实时监控目录下的多个追加文件</strong></p> <p>使用 <code>Taildir Source</code>，可以实现监控多个文件，并且可以实现断点续传。</p> <ol><li>创建 <code>job/flume-taildir-hdfs.conf</code></li></ol> <details class="custom-block details"><summary>实时监控多个追加文件</summary> <div class="language- line-numbers-mode"><pre class="language-text"><code>a4.sources = r4
a4.sinks = k4
a4.channels = c4

# 使用 Taildir Source，可以实现监控多个文件，并且可以实现断点续传
a4.sources.r4.type = TAILDIR
# 配置文件组
a4.sources.r4.filegroups = f1 f2
# 定义监控目录文件，组 f1 监控哪些文件
a4.sources.r4.filegroups.f1 = /opt/module/apache-flume-1.9.0/job/.*file.*
# 定义监控目录文件，组 f2 监控哪些文件
a4.sources.r4.filegroups.f2 = /opt/module/apache-flume-1.9.0/job/.*log.*
# 记录每一个文件读取到了哪个位置，是一个 json 文件
a4.sources.r4.positionFile = /opt/module/apache-flume-1.9.0/job/position.json

# Describe the sink
a4.sinks.k4.type = hdfs
a4.sinks.k4.hdfs.path = hdfs://hadoop102:8020/flume/upload2/%Y%m%d/%H
#上传文件的前缀
a4.sinks.k4.hdfs.filePrefix = upload-
#是否按照时间滚动文件夹
a4.sinks.k4.hdfs.round = true
#多少时间单位创建一个新的文件夹
a4.sinks.k4.hdfs.roundValue = 1
#重新定义时间单位
a4.sinks.k4.hdfs.roundUnit = hour
#是否使用本地时间戳
a4.sinks.k4.hdfs.useLocalTimeStamp = true
#积攒多少个Event才flush到HDFS一次
a4.sinks.k4.hdfs.batchSize = 100
#设置文件类型，可支持压缩
a4.sinks.k4.hdfs.fileType = DataStream
#多久生成一个新的文件
a4.sinks.k4.hdfs.rollInterval = 60
#设置每个文件的滚动大小大概是128M
a4.sinks.k4.hdfs.rollSize = 134217700
#文件的滚动与Event数量无关
a4.sinks.k4.hdfs.rollCount = 0

# Use a channel which buffers events in memory
a4.channels.c4.type = memory
a4.channels.c4.capacity = 1000
a4.channels.c4.transactionCapacity = 100

# Bind the source and sink to the channel
a4.sources.r4.channels = c4
a4.sinks.k4.channel = c4
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div></details> <h2 id="事务"><a href="#事务" class="header-anchor">#</a> 事务</h2> <p>事务为了保证的是事务中的内容要么同时成功，要么同时失败。主要是为了保持数据的完整性、安全性、一致性。</p> <p>在 Flume 中，数据是要进行多次传输的，所以为了保证数据中的完整性和一致性，必须要引入事务。</p> <p>那么从 Source -&gt; Channel 的过程中，需要进行传输，就要使用到事务。Channel -&gt; Sink 的时候，也必须要用到事务。</p> <p><strong>Put 事务</strong></p> <p>从 source -&gt; channel 的过程需要用到事务，我们叫做 put 事务。</p> <p>put 事务的流程：</p> <ol><li><p>source 进行一个攒批操作，也就是 batch data。</p></li> <li><p>source 微批次满了之后，进行一个 doPut 的操作，将 batch data 向一个缓冲区 putList 中放数据。</p></li> <li><p>缓冲区满了之后，执行一次 doCommit 操作，向 channel 中放数据。</p> <p>假如 doCommit 操作失败了，那么回滚数据。</p> <p>但是注意，Flume 中的回滚数据和我们之前别的技术中的回滚操作不一样，它会将 putList 中的数据全扔了，同时给 source 抛一个异常，告诉 source 这一批的数据失败了。</p> <p>之后 source 重新采集这一批的数据。</p></li></ol> <p><img src="/assets/img/2022-04-16-11-22-31.3e620299.png" alt=""></p> <p>我们说，putList 为缓冲区，缓冲区就肯定有大小，我们之前有配置：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># channel 的容量
a4.channels.c4.capacity = 1000
# 事务的容量，也就是 putList 能放多少个 Event
a4.channels.c4.transactionCapacity = 100
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>Task 事务</strong></p> <p>和 put 事务差不多，task 事务是 sink 从 channel 中拿取数据的事务。</p> <ol><li><p>batch data：channel 中拿到的数据攒一个微批次。</p></li> <li><p>doTask 操作，将 batch data 放到 taskList 中。</p></li> <li><p>doCommit：提交事务。</p> <p>处理数据失败了之后，会将 taskList 中的数据全部放回到 channel 中，注意，不是丢弃，是放回 channel 中。</p> <p>但是这样会导致一个问题，就是数据重复。</p> <p>原因是：假如 taskList 中的数据交给 sink 处理到一半失败了，那么数据全都放回到 channel 中，这样肯定是不会丢失数据。但是 sink 已经处理完的数据也没办法再要回来了。</p></li></ol> <p><img src="/assets/img/2022-04-16-11-29-20.d6adde15.png" alt=""></p> <h2 id="agent-内部原理"><a href="#agent-内部原理" class="header-anchor">#</a> Agent 内部原理</h2> <p>在 Agent 中，除了之前提到的 source、channel、sink 之外，还有其他组件：</p> <ul><li><p>channel processor</p> <p>在 source 给到 channel 之前，会先给 channel processor，它相当于在 channel 之前的一个拦截器。</p></li> <li><p>interceptor</p> <p>拦截器，可以有多个拦截器组成拦截器链。</p> <p>channel process 拦截到事件之后会交给拦截器链去处理事件，假如合法的事件则回到 channel processor，不合法就被拦截。</p></li> <li><p>channel selector</p> <p>经过了 channel processor 和 interceptor 之外，就要进入 channel selector 了。</p> <p>一个 source 可能会对应多个 channel，进入一个或者多个 channel，进入哪一个 channel 都是由 channel selector 决定的。</p> <p>channel selector 有两种类型：<code>replicating channel selector</code>、<code>multiplexing channel selector</code>。</p> <p>replicating，副本，顾名思义，可以将 source 发过来的 events 给所有 channel。</p> <p>multiplexing，多路，可以配置发送哪个 channel。</p></li> <li><p>channel：event 进入了 channel</p></li> <li><p>sink processor</p> <p>channel 的 event 也可以进入到多个 sink，那么配置进入哪个 sink 就是由 sink processor 决定的。</p> <p>sink processor 有三种：<code>default sink processor</code>、<code>load balancing sink processor</code>、<code>failover sink processor</code></p> <ul><li>default sink processor：它只允许有一个 sink 接收数据，我们默认用的就是这个。</li> <li>load balancing sink processor：负载均衡的 sink processor，负载均衡策略是可以配置的，比如轮询、随机等。</li> <li>failover sink processor：故障转移 sink processor，一开始只用一个 sink，假如这个 sink 故障了，那么就换另一个一直用。可以认为是高可用版本。</li></ul></li></ul> <h2 id="拓扑结构"><a href="#拓扑结构" class="header-anchor">#</a> 拓扑结构</h2> <p>拓扑结构，也就是多个 agent 怎么去接，多个 agent 怎么去接，B 里面的 source 怎么去接 A 里面的 sink。</p> <p><strong>简单串联</strong></p> <p><img src="/assets/img/2022-04-16-11-51-47.027b7e31.png" alt=""></p> <p>下游的是服务端，上游的是客户端。服务端的 source 接客户端的 sink。</p> <p>简单串联是最简单的拓扑结构，从实际意义上来看其实没啥用，组件越多风险就越大，但是重要的是可以让人快速理解啥是拓扑结构。</p> <p><strong>复制和多路复用</strong></p> <p><img src="/assets/img/2022-04-16-11-55-08.341bbc6f.png" alt=""></p> <p>一份数据做多次处理，或者将数据进行分离放到不同的位置中，这个是比较有用的。</p> <p><strong>负载均衡和故障转移</strong></p> <p><img src="/assets/img/2022-04-16-11-56-07.1136d444.png" alt=""></p> <p>Flume 支持将多个 sink 在逻辑上分到一个 sink 组，sink 组配合不同的 sink processor 可以实现负载均衡和错误恢复的功能。</p> <p><strong>聚合</strong></p> <p><img src="/assets/img/2022-04-16-11-57-13.3a12bd3b.png" alt=""></p> <p>最常见的拓扑结构。</p> <p><strong>案例</strong>
agent 的写法建议直接翻阅<a href="https://flume.apache.org/" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，里面标注的比较清楚。注意一点，因为 agent 之后需要放到同一个机器下，所以 agent 的名字不能相同。</p> <p><em>拓扑结构——复制</em></p> <p>使用 Flume-1 监控文件变动，将变动内容传递给 Flume-2 和 Flume-3。Flume-2 存到 HDFS，Flume-3 存到本地文件系统。</p> <p><img src="/assets/img/2022-04-16-12-05-44.84b01544.png" alt=""></p> <p><em>拓扑结构——负载均衡</em></p> <p><img src="/assets/img/2022-04-16-12-16-43.4da40605.png" alt=""></p> <p><em>拓扑结构——故障转移</em></p> <p><img src="/assets/img/2022-04-16-12-18-01.f1271450.png" alt=""></p> <p><em>拓扑结构——聚合</em></p> <p><img src="/assets/img/2022-04-16-12-19-31.3959df50.png" alt=""></p> <h2 id="自定义组件"><a href="#自定义组件" class="header-anchor">#</a> 自定义组件</h2> <p><strong>自定义 Interceptor</strong></p> <p>自定义 Interceptor</p> <ol><li><p>加 flume 的依赖：</p> <div class="language- extra-class"><pre><code> ```xml
 &lt;dependency&gt;
     &lt;groupId&gt;org.apache.flume&lt;/groupId&gt;
     &lt;artifactId&gt;flume-ng-core&lt;/artifactId&gt;
     &lt;version&gt;1.9.0&lt;/version&gt;
 &lt;/dependency&gt;
 ```
</code></pre></div></li> <li><p>继承 <code>org.apache.flume.interceptor.Interceptor</code> 接口，编写 builder 类。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
* 自定义拦截器
*/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EventHeaderInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">Interceptor</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token comment">/**
    * 拦截方法，处理每一个 Event
    */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Event</span> <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token class-name">Event</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// 1. 获取 event 的 headers</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> headers <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2. 获取 event 的 body，转为 utf-8（默认就是）</span>
        <span class="token class-name">String</span> body <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3. 处理内容</span>
        headers<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> event<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
    * 所有的 event
    */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Event</span><span class="token punctuation">&gt;</span></span> <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Event</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">::</span><span class="token function">intercept</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> list<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token comment">// flume 在之后会通过反射来创建对象，会通过 builder 来创建对象，所以我们需要提供 Builder 内部类</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">EventBuilder</span> <span class="token keyword">implements</span> <span class="token class-name">Builder</span> <span class="token punctuation">{</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token class-name">Interceptor</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">EventHeaderInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div></li> <li><p>打为 jar 包，放到 flume 中的 libs 目录下。</p></li> <li><p>指定 interceptor：<code>com.causes.flume.interceptor.EventHeaderInterceptor$EventBuilder</code>：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>a1.source.r1.interceptors = i1
a1.source.r1.interceptors.i1.type = com.causes.flume.interceptor.EventHeaderInterceptor$EventBuilder
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ol> <p><strong>自定义 Source</strong></p> <p>不重要，按照<a href="https://flume.apache.org/releases/content/1.8.0/FlumeDeveloperGuide.html#source" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>直接写。</p> <p><strong>自定义 Sink</strong></p> <p>按照<a href="https://flume.apache.org/releases/content/1.8.0/FlumeDeveloperGuide.html#sink" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>直接写。</p> <hr> <p>一半来说，Source 和 Sink 官方都考虑到了大量的场景，除非是一些冷门的需求，其余官方都考虑到了。</p></div> <!----> <div class="content__content-bottom"></div> <footer class="page-meta"><div class="edit-link"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon edit-icon"><path d="M117.953 696.992 64.306 959.696l265.931-49.336 450.204-452.505-212.284-213.376-450.204 452.513zm496.384-296.326L219.039 797.993l-46.108-46.34L568.233 354.33l46.104 46.335zm345.357-122.99-114.45 115.04-212.288-213.377 114.45-115.035 212.288 213.371zm0 0" fill="currentColor"></path></svg> <a href="https://gitlab.com/team401/knowledge/-/edit/main/bigdata/Flume/part1.md" target="_blank" rel="noopener noreferrer">Edit this page</a></div> <div class="meta-item update-time"><span class="label">Last update:</span> <span class="info">April 29, 2022 16:43</span></div> <div class="meta-item contributors"><span class="label">Contributors: </span> <span class="info"><span title="email: 2592716753@qq.com" class="contributor">
          红枫
        </span> , <span title="email: maple.wang@maiscrm.com" class="contributor">
          Maple Wang
        </span> <!----></span></div></footer> <!----> <!----> <!----> <div class="content__page-bottom"></div></main> <footer class="footer-wrapper"><!----> <div class="footer"><a href="https://beian.miit.gov.cn/#/Integrated/index">鲁ICP备20021989号-2</a></div> <!----></footer></div><div class="global-ui"><!----><!----><div id="pwa-install"><!----> <div id="install-modal-wrapper" style="display:none;"><div class="background"></div> <div class="install-modal"><div class="header"><button aria-label="Close" class="close-button"><svg width="23" height="22" xmlns="http://www.w3.org/2000/svg" class="icon close-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.12.358a1.224 1.224 0 011.729 0l8.92 8.914L20.686.358a1.224 1.224 0 011.73 1.728L13.497 11l8.92 8.913a1.222 1.222 0 11-1.73 1.729l-8.919-8.913-8.92 8.913a1.224 1.224 0 01-1.729-1.729L10.04 11l-8.92-8.914a1.222 1.222 0 010-1.728z" fill="currentColor"></path></svg></button> <div class="logo"><!----> <div class="title"><h1></h1> <p class="desc">This app can be installed on your PC or mobile device.  This will allow this web app to look and behave like any other installed app.  You will find it in your app lists and be able to pin it to your home screen, start menus or task bars.  This installed web app will also be able to safely interact with other apps and your operating system. </p></div></div></div> <div class="content"><div class="highlight"><!----> <!----></div> <div class="description"><h3>Description</h3> <p></p></div></div> <div class="button-wrapper"><button class="install-button">
        Install <span></span></button> <button class="cancel-button">
        Cancel
      </button></div></div></div></div><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button title="Close" aria-label="Close" class="pswp__button pswp__button--close"></button> <button title="Share" aria-label="Share" class="pswp__button pswp__button--share"></button> <button title="Switch to full screen" aria-label="Switch to full screen" class="pswp__button pswp__button--fs"></button> <button title="Zoom in/out" aria-label="Zoom in/out" class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button title="Prev (Arrow Left)" aria-label="Prev (Arrow Left)" class="pswp__button pswp__button--arrow--left"></button> <button title="Next (Arrow Right)" aria-label="Next (Arrow Right)" class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div></div>
    <script src="/assets/js/app.00946664.js" defer></script><script src="/assets/js/vendors~layout-Layout.d74da02a.js" defer></script><script src="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.70129eef.js" defer></script><script src="/assets/js/page-Flume.578f4bbc.js" defer></script>
  </body>
</html>
